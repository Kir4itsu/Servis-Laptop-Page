<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMLAPTOP - Komunitas Mahasiswa</title>
    <link rel="stylesheet" href="style.css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Typing Animation */
        .typing-dots {
            display: inline-flex;
            gap: 3px;
        }

        .typing-dots span {
            height: 8px;
            width: 8px;
            background: #718096;
            border-radius: 50%;
            display: inline-block;
            animation: typing 1.5s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: 0s; }
        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-5px);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
     <div class="container">
        
        <div id="header-placeholder"></div>

        <div id="beranda-section" class="section">
            <!-- Hero Section -->
            <div class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">Solusi Laptop untuk Mahasiswa</h1>
                    <p class="hero-subtitle">
                        Komunitas mahasiswa saling membantu dalam perawatan, troubleshooting, dan konsultasi laptop. 
                        Dapatkan poin dan tukarkan dengan free troubleshooting!
                    </p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary hero-btn" onclick="openModal('konsultasi')">
                            <i class="fas fa-rocket"></i>
                            Konsultasi Sekarang
                        </button>
                        <button class="btn btn-secondary hero-btn" onclick="showSection('artikel')">
                            <i class="fas fa-book"></i>
                            Lihat Artikel
                        </button>
                    </div>
                </div>
            </div>

            <!-- Stats Section -->
            <div class="stats-section">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-number">5.000+</div>
                    <div class="stat-label">Mahasiswa</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-star"></i></div>
                    <div class="stat-number">1.200+</div>
                    <div class="stat-label">Troubleshoot Berhasil</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-comments"></i></div>
                    <div class="stat-number">800+</div>
                    <div class="stat-label">Diskusi Aktif</div>
                </div>
            </div>

            <!-- Why Join Section -->
            <div class="why-join-section">
                <h2 class="section-title">
                    <i class="fas fa-sparkles"></i>
                    Kenapa Bergabung dengan SAMLAPTOP?
                </h2>
                <div class="benefits-grid">
                    <div class="benefit-item">
                        <div class="benefit-icon"><i class="fas fa-tools"></i></div>
                        <div class="benefit-text">
                            <h3>Akses teknisi mahasiswa terpercaya</h3>
                            <p>Dapatkan bantuan dari sesama mahasiswa yang sudah berpengalaman</p>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <div class="benefit-icon"><i class="fas fa-comment-dots"></i></div>
                        <div class="benefit-text">
                            <h3>Forum diskusi aktif dan suportif</h3>
                            <p>Bertanya dan berbagi pengalaman dengan komunitas yang solid</p>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <div class="benefit-icon"><i class="fas fa-gift"></i></div>
                        <div class="benefit-text">
                            <h3>Sistem poin dan reward menarik</h3>
                            <p>Dapatkan poin dari aktivitas dan tukar dengan layanan gratis</p>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <div class="benefit-icon"><i class="fas fa-book-open"></i></div>
                        <div class="benefit-text">
                            <h3>Artikel dan panduan perawatan laptop</h3>
                            <p>Akses panduan lengkap perawatan dan tips troubleshooting</p>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <div class="benefit-icon"><i class="fas fa-globe"></i></div>
                        <div class="benefit-text">
                            <h3>Konsultasi dan troubleshooting remote</h3>
                            <p>Bantuan teknis jarak jauh tanpa perlu keluar kampus</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rewards Section -->
            <div class="rewards-section">
                <div class="rewards-title">
                    <i class="fas fa-gem"></i>
                    Reward yang Bisa Ditukar
                </div>
                <div class="reward-items">
                    <div class="reward-item" onclick="openModal('redeem')">
                        <div style="font-size: 24px; margin-bottom: 8px;"><i class="fas fa-wrench"></i></div>
                        <div style="font-weight: 600; color: #2d3748;">Troubleshoot Remote</div>
                        <div style="color: #718096; font-size: 12px;">150 Poin</div>
                    </div>
                    <div class="reward-item" onclick="openModal('redeem')">
                        <div style="font-size: 24px; margin-bottom: 8px;"><i class="fas fa-video"></i></div>
                        <div style="font-weight: 600; color: #2d3748;">Konsultasi Premium</div>
                        <div style="color: #718096; font-size: 12px;">200 Poin</div>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <div class="content-section">
                    <div class="section-title">
                        <i class="fas fa-fire"></i>
                        Diskusi Terbaru di Komunitas
                    </div>
                    
                    <div class="discussion-card">
                        <div class="discussion-header">
                            <div class="user-avatar">AR</div>
                            <div class="user-info">
                                <div class="username">Ahmad Rizky</div>
                                <div class="user-major">Teknik Informatika - UI</div>
                            </div>
                            <div style="color: #718096; font-size: 12px;">3 jam lalu</div>
                        </div>
                        <div class="discussion-title">Cara mengatasi laptop overheating saat gaming</div>
                        <div class="discussion-preview">Laptop ASUS ROG saya sering panas banget saat main Valorant dan coding. Sudah coba bersihin kipas tapi masih sama...</div>
                        <div class="discussion-stats">
                            <div class="stat-item"><i class="fas fa-comment"></i> 24 Balasan</div>
                            <div class="stat-item"><i class="fas fa-heart"></i> 145 Suka</div>
                            <div class="stat-item"><i class="fas fa-book-open"></i> Baca Selengkapnya</div>
                        </div>
                    </div>

                    <div class="discussion-card">
                        <div class="discussion-header">
                            <div class="user-avatar">SW</div>
                            <div class="user-info">
                                <div class="username">Sari Wulandari</div>
                                <div class="user-major">Desain Komunikasi Visual - ITB</div>
                            </div>
                            <div style="color: #718096; font-size: 12px;">5 jam lalu</div>
                        </div>
                        <div class="discussion-title">Review laptop terbaik untuk desain grafis 2024</div>
                        <div class="discussion-preview">Sedang cari laptop untuk kuliah DKV, budget 10-15 juta. Butuh yang kuat buat Adobe Photoshop, Illustrator, dan Premiere Pro...</div>
                        <div class="discussion-stats">
                            <div class="stat-item"><i class="fas fa-comment"></i> 15 Balasan</div>
                            <div class="stat-item"><i class="fas fa-heart"></i> 98 Suka</div>
                            <div class="stat-item"><i class="fas fa-book-open"></i> Baca Selengkapnya</div>
                        </div>
                    </div>

                    <div class="discussion-card">
                        <div class="discussion-header">
                            <div class="user-avatar">DS</div>
                            <div class="user-info">
                                <div class="username">Dito Setiawan</div>
                                <div class="user-major">Ekonomi - UGM</div>
                            </div>
                            <div style="color: #718096; font-size: 12px;">8 jam lalu</div>
                        </div>
                        <div class="discussion-title">Tips merawat battery laptop biar awet</div>
                        <div class="discussion-preview">Battery laptop saya cepat banget habis, baru 1 tahun udah harus selalu dicharger. Ada tips merawat battery laptop agar tetap awet dan tahan lama?</div>
                        <div class="discussion-stats">
                            <div class="stat-item"><i class="fas fa-comment"></i> 32 Balasan</div>
                            <div class="stat-item"><i class="fas fa-heart"></i> 210 Suka</div>
                            <div class="stat-item"><i class="fas fa-book-open"></i> Baca Selengkapnya</div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-title">
                        <i class="fas fa-bolt"></i>
                        Aksi Cepat
                    </div>
                    
                    <div class="service-card" onclick="openModal('konsultasi')">
                        <div class="service-icon" style="background: linear-gradient(45deg, #48bb78, #38a169);"><i class="fas fa-comments"></i></div>
                        <div class="service-title">Konsultasi Laptop</div>
                        <div class="service-desc">Chat langsung dengan teknisi mahasiswa berpengalaman</div>
                    </div>
                    
                    <div class="service-card" onclick="openModal('troubleshoot')">
                        <div class="service-icon" style="background: linear-gradient(45deg, #ed8936, #dd6b20);"><i class="fas fa-tools"></i></div>
                        <div class="service-title">Remote Troubleshoot</div>
                        <div class="service-desc">Bantuan teknis jarak jauh untuk masalah laptop</div>
                    </div>
                    
                    <div class="service-card" onclick="openModal('tracking')">
                        <div class="service-icon" style="background: linear-gradient(45deg, #667eea, #764ba2);"><i class="fas fa-search"></i></div>
                        <div class="service-title">Lacak Status</div>
                        <div class="service-desc">Pantau progress perbaikan laptop Anda</div>
                    </div>
                </div>
            </div>

            <div class="services-grid">
                <div class="service-card" onclick="showSection('artikel')">
                    <div class="service-icon" style="background: linear-gradient(45deg, #4299e1, #3182ce);"><i class="fas fa-book"></i></div>
                    <div class="service-title">Artikel & Tips</div>
                    <div class="service-desc">Panduan lengkap perawatan dan troubleshooting laptop untuk mahasiswa</div>
                </div>
                
                <div class="service-card" onclick="showSection('teknisi')">
                    <div class="service-icon" style="background: linear-gradient(45deg, #38b2ac, #319795);"><i class="fas fa-user-cog"></i></div>
                    <div class="service-title">Daftar Teknisi</div>
                    <div class="service-desc">Jaringan teknisi mahasiswa terverifikasi di seluruh Indonesia</div>
                </div>
                
                <div class="service-card" onclick="showSection('reseller')">
                    <div class="service-icon" style="background: linear-gradient(45deg, #805ad5, #6b46c1);"><i class="fas fa-store"></i></div>
                    <div class="service-title">Reseller Terpercaya</div>
                    <div class="service-desc">Daftar reseller laptop dengan harga khusus mahasiswa</div>
                </div>
                
                <div class="service-card" onclick="showSection('komunitas')">
                    <div class="service-icon" style="background: linear-gradient(45deg, #f56565, #e53e3e);"><i class="fas fa-users"></i></div>
                    <div class="service-title">Komunitas</div>
                    <div class="service-desc">Bergabung dengan komunitas mahasiswa pecinta teknologi</div>
                </div>
            </div>
        </div>

        <!-- Other Sections -->
        <div id="artikel-section" class="section" style="display: none;">
            <div class="content-section">
                <div class="section-title"><i class="fas fa-book"></i> Artikel & Tips</div>
                <p>Bagian artikel akan dikembangkan...</p>
            </div>
        </div>

        <div id="komunitas-section" class="section" style="display: none;">
            <div class="content-section">
                <div class="section-title"><i class="fas fa-users"></i> Komunitas</div>
                <p>Bagian komunitas akan dikembangkan...</p>
            </div>
        </div>

        <div id="teknisi-section" class="section" style="display: none;">
            <div class="content-section">
                <div class="section-title"><i class="fas fa-user-cog"></i> Daftar Teknisi</div>
                <p>Bagian teknisi akan dikembangkan...</p>
            </div>
        </div>

        <div id="reseller-section" class="section" style="display: none;">
            <div class="content-section">
                <div class="section-title"><i class="fas fa-store"></i> Reseller</div>
                <p>Bagian reseller akan dikembangkan...</p>
            </div>
        </div>
    </div>

    <!-- Chat Widget -->
    <div class="chat-widget" onclick="openModal('chat')"><i class="fas fa-comment-dots"></i></div>

    <!-- Modal Login -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('login')">&times;</span>
            <h2 style="margin-bottom: 20px;">Masuk ke SAMLAPTOP</h2>
            <div class="form-group">
                <label class="form-label">Email/NIM</label>
                <input type="text" class="form-input" placeholder="Masukkan email atau NIM">
            </div>
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" class="form-input" placeholder="Masukkan password">
            </div>
            <button class="btn btn-primary" style="width: 100%;">Masuk</button>
            <p style="text-align: center; margin-top: 15px; color: #718096;">
                Belum punya akun? <a href="#" style="color: #667eea;">Daftar di sini</a>
            </p>
        </div>
    </div>

    <!-- Modal Konsultasi -->
    <div id="konsultasi-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('konsultasi')">&times;</span>
            <h2 style="margin-bottom: 20px;">Konsultasi Laptop</h2>
            <div class="form-group">
                <label class="form-label">Nama Lengkap</label>
                <input type="text" class="form-input" placeholder="Masukkan nama lengkap">
            </div>
            <div class="form-group">
                <label class="form-label">Universitas/Kampus</label>
                <input type="text" class="form-input" placeholder="Nama kampus">
            </div>
            <div class="form-group">
                <label class="form-label">Masalah Laptop</label>
                <textarea class="form-textarea" rows="4" placeholder="Jelaskan masalah yang dialami..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Tipe Konsultasi</label>
                <select class="form-select">
                    <option>Chat (Gratis - 50 Poin)</option>
                    <option>Video Call (Premium - 200 Poin)</option>
                </select>
            </div>
            <button class="btn btn-primary" style="width: 100%;">Mulai Konsultasi</button>
        </div>
    </div>

    <!-- Modal Troubleshoot -->
    <div id="troubleshoot-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('troubleshoot')">&times;</span>
            <h2 style="margin-bottom: 20px;">Remote Troubleshoot</h2>
            <div class="form-group">
                <label class="form-label">Nama Lengkap</label>
                <input type="text" class="form-input" placeholder="Masukkan nama lengkap">
            </div>
            <div class="form-group">
                <label class="form-label">Nomor WhatsApp</label>
                <input type="text" class="form-input" placeholder="08xxxxxxxxxx">
            </div>
            <div class="form-group">
                <label class="form-label">Masalah Yang Dialami</label>
                <textarea class="form-textarea" rows="4" placeholder="Jelaskan detail masalah laptop Anda..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Merk & Tipe Laptop</label>
                <input type="text" class="form-input" placeholder="Contoh: ASUS ROG Strix G15">
            </div>
            <p style="color: #718096; font-size: 14px; margin-bottom: 20px;">
                <i class="fas fa-lightbulb"></i> Biaya: 150 Poin | Estimasi waktu: 30-60 menit
            </p>
            <button class="btn btn-primary" style="width: 100%;">Request Troubleshoot</button>
        </div>
    </div>

    <!-- Modal Tracking -->
    <div id="tracking-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('tracking')">&times;</span>
            <h2 style="margin-bottom: 20px;">Lacak Status Pengerjaan</h2>
            <div class="form-group">
                <label class="form-label">Kode Tracking</label>
                <input type="text" class="form-input" placeholder="Masukkan kode tracking">
            </div>
            <button class="btn btn-primary" style="width: 100%; margin-bottom: 20px;">Cek Status</button>
            
            <div class="status-tracker">
                <h3 style="margin-bottom: 20px;">Status: Sedang Dikerjakan</h3>
                <div class="status-steps">
                    <div class="status-step completed">
                        <div class="status-icon"><i class="fas fa-check"></i></div>
                        <div>Diterima</div>
                    </div>
                    <div class="status-step completed">
                        <div class="status-icon"><i class="fas fa-check"></i></div>
                        <div>Diagnosa</div>
                    </div>
                    <div class="status-step active">
                        <div class="status-icon"><i class="fas fa-cog"></i></div>
                        <div>Perbaikan</div>
                    </div>
                    <div class="status-step">
                        <div class="status-icon"><i class="fas fa-box"></i></div>
                        <div>Selesai</div>
                    </div>
                </div>
                <div style="background: #f7fafc; padding: 15px; border-radius: 10px; margin-top: 20px;">
                    <p><strong>Update Terakhir:</strong> 26 September 2024, 14:30</p>
                    <p><strong>Teknisi:</strong> Ahmad Pratama (Teknik Informatika ITB)</p>
                    <p><strong>Catatan:</strong> Sedang mengganti thermal paste dan membersihkan kipas pendingin.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Chat dengan AI -->
    <div id="chat-modal" class="modal">
        <div class="modal-content" style="max-width: 600px; height: 70vh; display: flex; flex-direction: column;">
            <span class="close" onclick="closeModal('chat')">&times;</span>
            <h2 style="margin-bottom: 20px;">Chat dengan AI Assistant</h2>
            <p style="color: #718096; font-size: 14px; margin-bottom: 15px; text-align: center;">
                <i class="fas fa-robot"></i> Asisten virtual untuk konsultasi laptop
            </p>
            
            <div id="chat-messages" style="flex: 1; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; margin-bottom: 15px; background: #f7fafc;">
                <!-- Pesan awal -->
                <div style="margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                        <div style="width: 30px; height: 30px; border-radius: 50%; background: #667eea; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">AI</div>
                        <span style="font-size: 12px; color: #718096;">Sekarang</span>
                    </div>
                    <div style="background: white; padding: 12px; border-radius: 10px; margin-left: 40px; max-width: 70%;">
                        Halo! Saya asisten AI SAMLAPTOP ðŸ‘‹<br><br>
                        Saya siap membantu masalah laptop Anda. Ceritakan:
                        â€¢ Gejala yang dialami
                        â€¢ Merk & tipe laptop  
                        â€¢ Kapan masalah mulai terjadi
                        â€¢ Pesan error (jika ada)
                        <div style="font-size: 10px; color: #718096; margin-top: 5px; text-align: right;">Powered by AI</div>
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chat-input" class="form-input" placeholder="Tulis masalah laptop Anda..." style="flex: 1;" onkeypress="handleChatInput(event)">
                <button class="btn btn-primary" onclick="sendAIMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            
            <div style="margin-top: 10px; text-align: center;">
                <button class="btn btn-secondary" onclick="clearChat()" style="font-size: 12px; padding: 5px 10px;">
                    <i class="fas fa-trash"></i> Bersihkan Chat
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Redeem -->
    <div id="redeem-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('redeem')">&times;</span>
            <h2 style="margin-bottom: 20px;">Tukar Poin Reward</h2>
            <div style="text-align: center; margin-bottom: 25px;">
                <div class="points-badge" style="display: inline-block; font-size: 18px;">
                    <i class="fas fa-bullseye"></i> Poin Anda: 250
                </div>
            </div>
            
            <div style="border: 2px solid #e2e8f0; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                    <div style="font-size: 40px;"><i class="fas fa-wrench" style="color: #667eea;"></i></div>
                    <div>
                        <h3>Troubleshoot Remote 30 Menit</h3>
                        <p style="color: #718096; margin: 5px 0;">Bantuan teknis jarak jauh oleh teknisi mahasiswa</p>
                        <div style="background: linear-gradient(45deg, #ffd89b, #19547b); color: white; padding: 5px 10px; border-radius: 15px; display: inline-block; font-size: 12px;">
                            150 Poin
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="redeemReward('troubleshoot')">
                    Tukar Sekarang
                </button>
            </div>
            
            <div style="border: 2px solid #e2e8f0; border-radius: 15px; padding: 20px;">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                    <div style="font-size: 40px;"><i class="fas fa-video" style="color: #718096;"></i></div>
                    <div>
                        <h3>Konsultasi Premium 1 Jam</h3>
                        <p style="color: #718096; margin: 5px 0;">Video call dengan teknisi berpengalaman</p>
                        <div style="background: linear-gradient(45deg, #ffd89b, #19547b); color: white; padding: 5px 10px; border-radius: 15px; display: inline-block; font-size: 12px;">
                            200 Poin
                        </div>
                    </div>
                </div>
                <button class="btn btn-secondary" style="width: 100%;" disabled>
                    Poin Tidak Cukup
                </button>
            </div>
        </div>
    </div>

     <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Bottom Navigation for Mobile -->
    <div id="nav-placeholder"></div>

    <script>
        // AI Chat Functionality
        let chatHistory = [
            {
                role: "user",
                parts: [{ text: "Kamu adalah asisten virtual ahli laptop untuk SAMLAPTOP - komunitas mahasiswa saling membantu dalam perawatan dan troubleshooting laptop. PROFIL KAMU: - Nama: TechBot SAMLAPTOP - Keahlian: Troubleshooting laptop, perawatan hardware/software, optimasi performa - Bahasa: Indonesia informal yang ramah dan mudah dipahami mahasiswa - Tujuan: Bantu diagnosa masalah dan berikan solusi praktis ATURAN UTAMA: 1. FOKUS pada masalah teknis laptop (hardware, software, performa, dll) 2. Berikan solusi STEP-BY-STEP yang bisa dicoba sendiri 3. Jika kompleks, sarankan hubungi teknisi SAMLAPTOP 4. JANGAN beri saran buka hardware jika user pemula 5. JANGAN jawab pertanyaan di luar topik laptop" }]
            },
            {
                role: "model",
                parts: [{ text: "Halo! ðŸ‘‹ Saya TechBot SAMLAPTOP, ahli troubleshooting laptop. Ada masalah laptop apa yang bisa saya bantu? Ceritakan gejala dan merk laptop Anda!" }]
            }
        ];

        async function sendAIMessage() {
            const chatInput = document.getElementById('chat-input');
            const chatMessages = document.getElementById('chat-messages');
            const message = chatInput.value.trim();
            
            if (!message) return;
            
            // Add user message to UI
            addMessageToChat('user', message);
            chatInput.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Get AI response
                const aiResponse = await getAIResponse(message);
                
                // Remove typing indicator and add AI response
                removeTypingIndicator();
                addMessageToChat('assistant', aiResponse);
                
            } catch (error) {
                console.error('Error:', error);
                removeTypingIndicator();
                
                // Fallback responses if API fails
                const fallbackResponses = [
                    "Maaf, saat ini saya sedang mengalami gangguan teknis. Silakan hubungi teknisi langsung melalui menu konsultasi.",
                    "Sistem sedang sibuk. Bisa Anda coba lagi sebentar lagi?",
                    "Untuk mendapatkan bantuan lebih cepat, silakan gunakan layanan konsultasi premium dengan teknisi kami."
                ];
                const randomResponse = fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];
                addMessageToChat('assistant', randomResponse);
            }
        }

        // Function to add message to chat UI
        function addMessageToChat(role, message) {
            const chatMessages = document.getElementById('chat-messages');
            const timestamp = new Date().toLocaleTimeString('id-ID', {hour: '2-digit', minute: '2-digit'});
            
            const messageHtml = `
                <div style="margin-bottom: 15px; ${role === 'user' ? 'text-align: right;' : ''}">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px; ${role === 'user' ? 'justify-content: flex-end;' : ''}">
                        ${role === 'user' ? 
                            `<span style="font-size: 12px; color: #718096;">${timestamp}</span>
                             <div style="width: 30px; height: 30px; border-radius: 50%; background: #48bb78; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">Anda</div>` :
                            `<div style="width: 30px; height: 30px; border-radius: 50%; background: #667eea; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">AI</div>
                             <span style="font-size: 12px; color: #718096;">${timestamp}</span>`
                        }
                    </div>
                    <div style="background: ${role === 'user' ? '#667eea' : 'white'}; color: ${role === 'user' ? 'white' : '#2d3748'}; padding: 12px; border-radius: 10px; ${role === 'user' ? 'margin-right: 40px; display: inline-block;' : 'margin-left: 40px;'} max-width: 70%; word-wrap: break-word;">
                        ${message}
                        ${role === 'assistant' ? '<div style="font-size: 10px; color: #718096; margin-top: 5px; text-align: right;">Powered by AI</div>' : ''}
                    </div>
                </div>
            `;
            
            chatMessages.innerHTML += messageHtml;
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to chat history for context
            if (role === 'user') {
                chatHistory.push({
                    role: "user",
                    parts: [{ text: message }]
                });
            } else {
                chatHistory.push({
                    role: "model", 
                    parts: [{ text: message }]
                });
            }
            
            // Keep only last 10 messages for context
            if (chatHistory.length > 10) {
                chatHistory = chatHistory.slice(-10);
            }
        }

        // Typing indicator functions
        function showTypingIndicator() {
            const chatMessages = document.getElementById('chat-messages');
            const typingHtml = `
                <div style="margin-bottom: 15px;" id="typing-indicator">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                        <div style="width: 30px; height: 30px; border-radius: 50%; background: #667eea; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">AI</div>
                        <span style="font-size: 12px; color: #718096;">${new Date().toLocaleTimeString('id-ID', {hour: '2-digit', minute: '2-digit'})}</span>
                    </div>
                    <div style="background: white; padding: 12px; border-radius: 10px; margin-left: 40px; display: inline-block;">
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            `;
            
            chatMessages.innerHTML += typingHtml;
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // AI Response Function using Google Gemini API
        async function getAIResponse(userMessage) {
            const API_KEY = 'AIzaSyDMh_DjIoztoYoxuVRJqZIlxtc_LH6yJ1U'; 
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: chatHistory.concat([
                            {
                                role: "user",
                                parts: [{ text: userMessage }]
                            }
                        ]),
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 1024,
                        },
                        safetySettings: [
                            {
                                category: "HARM_CATEGORY_HARASSMENT",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            },
                            {
                                category: "HARM_CATEGORY_HATE_SPEECH", 
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            }
                        ]
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.candidates && data.candidates[0].content.parts[0].text) {
                    return data.candidates[0].content.parts[0].text;
                } else {
                    console.error('Unexpected API response:', data);
                    throw new Error('No response from AI');
                }
                
            } catch (error) {
                console.error('AI API Error:', error);
                throw error;
            }
        }

        
        // Handle Enter key in chat
        function handleChatInput(e) {
            if (e.key === 'Enter') {
                sendAIMessage();
            }
        }

        // Clear chat history
        function clearChat() {
            const chatMessages = document.getElementById('chat-messages');
            chatMessages.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                        <div style="width: 30px; height: 30px; border-radius: 50%; background: #667eea; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">AI</div>
                        <span style="font-size: 12px; color: #718096;">Sekarang</span>
                    </div>
                    <div style="background: white; padding: 12px; border-radius: 10px; margin-left: 40px; max-width: 70%;">
                        Halo! Percakapan telah dimulai ulang. Ada yang bisa saya bantu terkait masalah laptop Anda?
                        <div style="font-size: 10px; color: #718096; margin-top: 5px; text-align: right;">Powered by AI</div>
                    </div>
                </div>
            `;
            
            chatHistory = [
                {
                    role: "user", 
                    parts: [{ text: "Kamu adalah asisten virtual ahli laptop untuk SAMLAPTOP. Mulai percakapan baru." }]
                },
                {
                    role: "model",
                    parts: [{ text: "Halo! Percakapan telah dimulai ulang. Ada yang bisa saya bantu terkait masalah laptop Anda?" }]
                }
            ];
        }

        // Load header & footer
        fetch("extension.html")
            .then(res => res.text())
            .then(html => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, "text/html");
                document.getElementById("header-placeholder").innerHTML =
                    doc.getElementById("main-header").innerHTML;
                document.getElementById("footer-placeholder").innerHTML =
                    doc.getElementById("main-footer").innerHTML;
                
                // Set active navigation setelah header dimuat
                setTimeout(() => {
                    setActiveNavbar();
                }, 100);
            });

        // Fungsi untuk set active navbar
        function setActiveNavbar() {
            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            
            console.log('Current page:', currentPage);
            
            // Set active untuk desktop nav
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
                const itemPage = item.getAttribute('data-page');
                console.log('Checking:', itemPage, 'vs', currentPage);
                if (itemPage === currentPage) {
                    item.classList.add('active');
                    console.log('âœ… Activated:', item.textContent);
                }
            });

            // Set active untuk bottom nav
            const bottomNavItems = document.querySelectorAll('.bottom-nav-item');
            bottomNavItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-page') === currentPage) {
                    item.classList.add('active');
                }
            });
        }

        // Fungsi untuk show section
        function showSection(section) {
            const pageMap = {
                'beranda': 'index.html',
                'artikel': 'artikel.html', 
                'komunitas': 'komunitas.html',
                'teknisi': 'teknisi.html',
                'reseller': 'reseller.html'
            };
            
            const targetPage = pageMap[section];
            
            if (targetPage && targetPage !== window.location.pathname.split('/').pop()) {
                window.location.href = targetPage;
            }
        }

        // Fungsi untuk bottom nav
        function setActiveBottomNav(element) {
            const bottomNavItems = document.querySelectorAll('.bottom-nav-item');
            bottomNavItems.forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');
        }

        // Global variables
        let currentSection = 'beranda';
        let userPoints = 250;
        
        // Modal Management
        function openModal(modalName) {
            const modal = document.getElementById(modalName + '-modal');
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal(modalName) {
            const modal = document.getElementById(modalName + '-modal');
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        }
        
        // Redeem reward functionality
        function redeemReward(rewardType) {
            const requiredPoints = rewardType === 'troubleshoot' ? 150 : 200;
            
            if (userPoints >= requiredPoints) {
                userPoints -= requiredPoints;
                
                // Update points display
                const pointsBadges = document.querySelectorAll('.points-badge');
                pointsBadges.forEach(badge => {
                    if (badge.textContent.includes('Poin')) {
                        badge.innerHTML = `<i class="fas fa-bullseye"></i> ${userPoints} Poin`;
                    }
                });
                
                // Show success message
                alert(`Berhasil menukar reward! Poin Anda sekarang: ${userPoints}`);
                
                closeModal('redeem');
                
                // Open relevant service modal
                if (rewardType === 'troubleshoot') {
                    openModal('troubleshoot');
                } else {
                    openModal('konsultasi');
                }
            } else {
                alert('Poin Anda tidak cukup untuk menukar reward ini.');
            }
        }
        
        // Add points for activities (demo)
        function addPoints(points, activity) {
            userPoints += points;
            
            // Update points display
            const pointsBadges = document.querySelectorAll('.points-badge');
            pointsBadges.forEach(badge => {
                if (badge.textContent.includes('Poin')) {
                    badge.innerHTML = `<i class="fas fa-bullseye"></i> ${userPoints} Poin`;
                }
            });
            
            // Show notification
            showNotification(`+${points} poin dari ${activity}!`);
        }
        
        // Notification system
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: linear-gradient(45deg, #48bb78, #38a169);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 8px 25px rgba(72, 187, 120, 0.3);
                z-index: 10000;
                animation: slideInRight 0.3s ease;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Add CSS animation for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(100px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);
        
        // Demo: Add points when user interacts with discussions
        document.addEventListener('DOMContentLoaded', function() {
            const discussionCards = document.querySelectorAll('.discussion-card');
            discussionCards.forEach(card => {
                card.addEventListener('click', function() {
                    // Simulate earning points for reading discussions
                    const hasEarned = this.getAttribute('data-points-earned');
                    if (!hasEarned) {
                        addPoints(5, 'membaca diskusi');
                        this.setAttribute('data-points-earned', 'true');
                    }
                });
            });
        });
        
        // Form submission handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Handle form submissions
            const primaryButtons = document.querySelectorAll('.modal .btn-primary');
            primaryButtons.forEach(button => {
                if (!button.onclick && !button.getAttribute('data-has-handler')) {
                    button.setAttribute('data-has-handler', 'true');
                    button.addEventListener('click', function(e) {
                        const modalContent = this.closest('.modal-content');
                        const modalTitle = modalContent.querySelector('h2').textContent;
                        
                        // Skip if this is redeem button or send message button
                        if (this.textContent.includes('Tukar') || this.textContent.includes('Kirim') || this.textContent.includes('Cek Status')) {
                            return;
                        }
                        
                        // Simulate form processing
                        const originalText = this.textContent;
                        this.textContent = 'Memproses...';
                        this.disabled = true;
                        
                        setTimeout(() => {
                            if (modalTitle.includes('Konsultasi')) {
                                addPoints(10, 'memulai konsultasi');
                                alert('Konsultasi berhasil dimulai! Teknisi akan menghubungi Anda dalam 5 menit.');
                            } else if (modalTitle.includes('Troubleshoot')) {
                                alert('Request troubleshoot berhasil dikirim! Kami akan menghubungi Anda via WhatsApp.');
                            } else if (modalTitle.includes('Masuk')) {
                                addPoints(25, 'login harian');
                                alert('Selamat datang kembali! Bonus 25 poin login harian.');
                            }
                            
                            // Reset button
                            this.disabled = false;
                            this.textContent = originalText;
                            
                            // Close modal
                            const modal = this.closest('.modal');
                            modal.style.display = 'none';
                            document.body.style.overflow = 'auto';
                        }, 2000);
                    });
                }
            });
        });
        
        // Smooth scrolling for better user experience
        document.addEventListener('DOMContentLoaded', function() {
            // Add smooth scroll behavior
            document.documentElement.style.scrollBehavior = 'smooth';
            
            // Header scroll effect (optional enhancement)
            let lastScrollTop = 0;
            const header = document.querySelector('.header');
            
            window.addEventListener('scroll', function() {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // Add shadow on scroll
                if (scrollTop > 10) {
                    header.style.boxShadow = '0 8px 32px rgba(0, 0, 0, 0.2)';
                } else {
                    header.style.boxShadow = '0 8px 32px rgba(0, 0, 0, 0.1)';
                }
                
                lastScrollTop = scrollTop;
            });
        });
    </script>
</body>
</html>